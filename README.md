# yuzu-ilo
yuzuru_sofiaによるyuzuru_sofiaのためのツール。  
自作しているdiscordのbot用の機能だったり自言語関連の機能だったりいろいろです。  
yuzu_ilo.pyが本体です。

# 主な機能
- dice
  - ダイスコードを入れるとさいころを振ってくれます。
- dice_2
  - 上の機能に加えてseed値を設定できるようになっています。
  - seed値はdiceとdice_2で別で管理されています。
- efia
  - unixtimeをefia数に変換できます。
  - unixtimeを省略したときは今日のefia数を確認できます。
  - int型で受け取りたいならefia_intが使えます。
- yuki_kekamu
  - int型のefia数をyuki暦での日付に変換できます。
  - efia数を省略したときは今日のyuki暦での日付を確認できます。
- magic_square_4
  - 好きな数字を4つ入れて4次魔方陣を作れます。
    - 見つかった魔方陣の2次元リストがすべて入ったリストが返ってきます。
    - 見つからなかった場合は空のリストが返ってきます。
  - デフォルトでは0以上の数を使用します。
  - 総当たりしているので入れる数字によってはものすごく時間がかかります。
- is_magic_square
  - 魔方陣かどうかを判定できます。
  - list, tuple, np.ndarrayの中のどれかの型である必要があります。
- is_panmagic_square
  - 完全魔方陣かどうかを判定できます。
- ante_nanpa
  - nasin nanpa puで書かれた数とint型での数を相互に変換します。
- ante_nanpa_pona
  - nasin nanpa ponaで書かれた数とint型での数を相互に変換します。
- prsk
  - プロセカのリザルトのPERFECT, GREAT, GOOD, BAD, MISSを順番にいれると、いろいろなものを確認できます。
    - PERFECTを100%、GREATを70%、GOODを50%としたときの達成率
    - ランクマッチでのスコア
    - ランクマッチでの理論値から何点減ったか
  - 最後に0が続くときは省略できます。
    - フルコンボならPERFECTとGREATだけで確認できます。
    - BADとMISSは足してから入れても計算に影響しません。
  - ノーツの種類を無視して計算しています。
- list_int_kebab
  - ハイフンで繋がれた数字をlist型に変換します。
  - prskと組み合わせると便利？
- str_pct
  - floot型の数字をいれると小数点第4位までのパーセント表記に変換します。
- pascal_snake
  - Capitalized_Words_With_Underscores
- base_conv
  - str型の変換前の数字と変換後の底をいれると進数変換ができます。
    - 変換前の数字にはint型も使えます。
  - 変換前と変換後の両方で2進数から36進数までを使えます。
    - 大文字と小文字は区別しません。
  - 変換前の数の桁区切りにアンダースコアが使えます。
  - 変換前の数が十進数ならそのまま変換できます。
  - 変換前の数が二進数、八進数、十六進数のどれかなら、プレフィックスの0b, 0o, 0xを使えます。
    - 0B, 0O, 0Xも使えます。
  - それ以外の場合は「(変換前の数の進法):(変換前の数)」のように入れます。
    - 変換前の数字に「12:987」のようにいれると十二進数の987と解釈されます。
    - 0b, 0o, 0xが接頭辞なのでそれに合わせました。

# バクっぽい仕様
- dice, dice_2
  - 一般的にダイスコードと認識されなさそうなものでもダイスコードとして認識します。
    - 20は1d20と解釈される。
    - 6+1は1d6+1と解釈される。
    - 2d+1は2d6+1と解釈される。

# 既知の問題 (修正予定のないもの、未検証のもの含む)
- float型でも「nanpa ala」と言われる。
- 107行目から113行目
- efiaとyuki_kekamuの年がマイナスになるときはマイナスの記号にハイフンではなくチルダを使ったほうがいいかもしれない。
- pascal_snakeが元々大文字だけの単語を最初の文字以外を小文字に変換する。
  - capwordsの仕様が原因
  - コーディング規則によって違ったりするらしいし別にいいかなー…
    - (でも個人的には大文字だけの単語は大文字だけのままがいい)
- base_convertが2:12345のような矛盾したものを検知できない。
  - 検知したところで結局ValueErrorにするのでわざわざ検知する理由がない。
- 全体的に命名があんまりよくない気がする。
  - 特にis_alphaは大文字と小文字の区別がある文字かどうかの確認をするために作ったのに名前に一切反映されていない。
  - (最近の変更でたぶんましになった)
- 238行目を消せるかもしれない。
  - 消すなら253行目も書き換える。
- 実はmagic_square_4の総当たりの効率が悪いかもしれない。
  - A4, A2, B2, C2で総当たりすると3つ目の仮定の時点で10個確定
  - A4, B4, B2, D2で総当たりすると3つ目の仮定の時点で12個確定
    - たぶん12個確定するパターンは他にもある。
    - 13個以上確定は多分ない。(あったら全部確定してるはず)
    - 2つ目の仮定の時点でもっと多く確定するものがあるならそれを使いたい。
  - ついでにset型を使うようにしたほうがいいのだろうか。
  - 多分劇的に早くはならないし、結果の順番も変わるからいったん放置。
- インデントにtab文字を使っている。
  - サクラエディタでプログラムを書いてる間はずっとtab文字のままになると思います。

# そのほか
2025年1月19日にわりと大規模な変更をしたからそのままyuzu_iloだけ置き換えると動かないかも

